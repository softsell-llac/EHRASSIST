import { Map } from '../roles/util.js';
const users = (connection) => {
  return {
    getMyUser: () => connection.get('/users/own-info').then(Map.user),
    getAssignedRoles: (userId) => connection.get(`/authz/users/${userId}/roles`).then(Map.roles),
    assignRoles: (roleNames, userId) =>
      connection.postEmpty(`/authz/users/${userId}/assign`, {
        roles: Array.isArray(roleNames) ? roleNames : [roleNames],
      }),
    revokeRoles: (roleNames, userId) =>
      connection.postEmpty(`/authz/users/${userId}/revoke`, {
        roles: Array.isArray(roleNames) ? roleNames : [roleNames],
      }),
  };
};
export default users;
