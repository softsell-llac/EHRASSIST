'use strict';
Object.defineProperty(exports, '__esModule', { value: true });
const util_js_1 = require('../roles/util.js');
const users = (connection) => {
  return {
    getMyUser: () => connection.get('/users/own-info').then(util_js_1.Map.user),
    getAssignedRoles: (userId) => connection.get(`/authz/users/${userId}/roles`).then(util_js_1.Map.roles),
    assignRoles: (roleNames, userId) =>
      connection.postEmpty(`/authz/users/${userId}/assign`, {
        roles: Array.isArray(roleNames) ? roleNames : [roleNames],
      }),
    revokeRoles: (roleNames, userId) =>
      connection.postEmpty(`/authz/users/${userId}/revoke`, {
        roles: Array.isArray(roleNames) ? roleNames : [roleNames],
      }),
  };
};
exports.default = users;
